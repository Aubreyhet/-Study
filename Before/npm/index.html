<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="index.css">
    <title>npm包管理工具</title>
</head>
<body>
    <div class="center">
        <h1>npm模块管理器</h1>
        <h2>目录</h2>
        <div>
            <ul>
                <a href="#one">
                    <li>
                        <div>1. 简介</div>
                    </li>
                </a>
                <a href="#init">
                    <li>
                        <div>2. npm init</div>
                    </li>
                </a>
                <a href="#set">
                    <li>
                        <div>3. npm set</div>
                    </li>
                </a>
                <a href="#config">
                    <li>
                        <div>4. npm config</div>
                    </li>
                </a>
                <a href="#info">
                    <li>
                        <div>5. npm info</div>
                    </li>
                </a>
                <a href="#search">
                    <li>
                        <div>6. npm search</div>
                    </li>
                </a>
                <a href="#list">
                    <li>
                       <div> 7. npm list</div>
                    </li>
                </a>
                <a href="#install">
                    <li><div> 8. npm install</div>
                        <ul>
                            <a href="#install-one">
                                <li>
                                   <div> 8.1 基本用法</div>
                                </li>
                            </a>
                            <a href="#install-two">
                                <li>
                                    <div> 8.2 安装不同版本</div>
                                </li>
                            </a>
                        </ul>
                    </li>
                </a>
                <a href="#root">
                    <li>
                        <div> 9. 避免系统权限</div>
                    </li>
                </a>
                <a href="#update">
                    <li>
                        <div> 10. npm update, npm uninstall</div>
                    </li>
                </a>
                <a href="#run">
                    <li>
                        <div>11. npm run</div>
                        <ul>
                            <a href="">
                                <li>
                                    <div>11.1 参数</div>
                                </li>
                            </a>
                            <a href="">
                                <li>
                                    <div>11.2 script脚本命令最佳实践</div>
                                </li>
                            </a>
                            <a href="">
                                <li>
                                    <div>11.3 pre- 和 post- 脚本</div>
                                </li>
                            </a>
                            <a href="">
                                <li>
                                    <div>11.4 内部变量</div>
                                </li>
                            </a>
                            <a href="">
                                <li>
                                    <div>11.5 通配符</div>
                                </li>
                            </a>
                        </ul>
                    </li>
                </a>
                <a href="">
                    <li>
                        <div>12. npm link</div>
                    </li>
                </a>
                <a href="">
                    <li>
                        <div>13. npm bin</div>
                    </li>
                </a>
                <a href="">
                    <li>
                        <div>14. npm adduser</div>
                    </li>
                </a>
                <a href="">
                    <li>
                        <div>15. npm publish</div>
                    </li>
                </a>
                <a href="">
                    <li>
                        <div>16. npm deprecate</div>
                    </li>
                </a>
                <a href="">
                    <li>
                        <div>17. npm owner</div>
                    </li>
                </a>
                <a href="">
                    <li>
                        <div>18. 其他命令</div>
                        <ul>
                            <a href="">
                                <li>
                                    <div>18.1 npm home,npm repo</div>
                                </li>
                            </a>
                            <a href="">
                                <li>
                                    <div>18.2 npm outdated</div>
                                </li>
                            </a>
                            <a href="">
                                <li>
                                    <div>18.3 npm prune</div>
                                </li>
                            </a>
                            <a href="">
                                <li>
                                    <div>18.4 npm shrinkwrap</div>
                                </li>
                            </a>
                        </ul>
                    </li>
                </a>
                <a href="">
                    <li>
                        <div>19.参考链接</div>
                    </li>
                </a>
            </ul>
        </div>
        <h2 id="one">1.简介</h2>
        <div class="narration">
            <p><code>npm</code>有两层含义。一层含义是Node的开放式模块登记和管理系统，网址为<a href="https://www.npmjs.com/">npmjs.org</a> 。另一层含义是Node默认的模块管理器，是一个命令行下的软件，用来安装和管理Node模块。</p>
            <p>npm不需要单独安装。在安装Node的时候，会连带一起安装npm。但是，Node附带的npm可能不是最新版本，最好用下面的命令，更新到最新版本。</p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>$ npm install npm@latest -g</p>
            </div>
        </div>
        <div class="narration">
            <p>
                上面的命令中，@latest表示最新版本，-g表示全局安装。所以，命令的主干是npm install npm，也就是使用npm安装自己。之所以可以这样，是因为npm本身与Node的其他模块没有区别。
                然后，运行下面的命令，查看各种信息。
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <span># 查看 npm 命令列表</span>
                <p>$ npm help</p>
                <br>
                <span># 查看各个命令简单用法</span>
                <p>$ npm -1</p>                                                 
                <span># 查看npm的版本</span>
                <p>$ npm -v</p>
                <span># 查看npm的配置</span>
                <p>$ npm config list -1</p>
            </div>
        </div>
        <h2 id="init">2. npm init</h2>
        <div class="narration">
            <p><code>npm init</code>用来初始化生成一个新的<code>package.json</code>文件。他会向用户提问一系列问题，如果你觉得不用修改默认配置，一路回车就可以了。</p>
            <p>如果使用了<code>-f</code>、<code>-y</code>则跳过提问阶段，直接生成一个新的<code>package.json</code>文件。 </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>$ npm init</p>
            </div>
        </div>
        <h2 id="test">3. npm set</h2>
        <div class="narration">
            <p><code>npm set</code>用来设置环境变量。</p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>$ npm set init-author-name 'Your name'</p>
                <p>$ npm set init-author-email 'Your email'</p>
                <p>$ npm set init-author-url 'http://yourdomain.com'</p>
                <p>$ npm set init-license 'MIT'</p>
            </div>
        </div>
        <div class="narration">
            <p>上边的代码等于为<code>npm init</code>设置了默认值，所以执行<code>npm init</code>的时候，<code>package.json</code>的
            作者姓名、邮箱、主页、许可证字段就会自动写入预设的值。这些信息会存放在用户主目录的<code>~/.npmrc</code>文件，使得用户不用每个项目都输入。如果某个项目
            有不同的设置，可以针对该项目运行<code>npm config</code>。</p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>$ npm set save-exact true</p>
            </div>
        </div>
        <div class="narration">
            <p>上面命令设置加入模块时，<code>pack.json</code>将记录模块的确切版本而不是一个可选的版本范围</p>
        </div>
        <h2 id="config">4. npm config</h2>
        <div class="code-abroad">
            <div class="code">
                <p>$ npm config set prefix $dir</p>
            </div>
        </div>
        <div class="carration">
            <p>
                上面的命令将指定的<code>$dir</code>目录。如果当前有这个目录的写权限，那么运行<code>npm install</code>的时候，就不再需要<code>sudo</code>命令授权了。
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>
                    $ npm config set save-prefix ~
                </p>
            </div>
        </div>
        <div class="carration">
            <p>
                上面的代码使得<code>npm install --save</code>和<code>npm install --save-dev</code>安装新模块时，允许的版本范围从克拉符号（<code>^</code>）
                改成波浪号（<code>~</code>），即使允许小版本升级，变成只允许补丁包的升级。
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>
                    $ npm config set init.author.name $name
                </p>
                <p>
                    $ npm config set init.author.email $email
                </p>
            </div>
        </div>
        <div class="carration">
            <p>
                上面命令指定使用<code>npm init</code>时，生成的<code>package.json</code>文件的字段默认值
            </p>
        </div>
        <h2 di="info">5. npm info</h2>
        <div class="carration">
            <p>
                <code>npm info</code>命令可以查看每个模块的具体信息。比如，查看description模块的信息，如图0101。
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <img src="./img/0101.png" alt="0101">
            </div>
        </div>
        <h2 id="search">6. npm search</h2>
        <div class="carration">
            <p><code>npm search</code>命令用于搜索npm仓库，它后边可以跟字符串，也可以跟正则表达式。</p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>
                    $ npm search &lt;搜索词&gt;
                </p>
            </div>
        </div>
        <div class="carration">
            <p>
                下面是个例子
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>$ npm search node-gyp</p>
                <p>// NAME             DESCRIPTION</p>
                <p>// autogypi         Autogypi handles dependencies for node-gyp projects</p>
                <p>// grunt-node-gyp   Run node-gyp commands from Grunt.</p>
                <p>// gyp-io           Temporary aolution to let node-gyp run `rebuild` under...</p>
                <p>// ...</p>
                
            </div>
        </div>
        <h2 id="list">7. npm list</h2>
        <div class="carration">
            <p><code>npm list</code>命令以树形结构列出当前项目安装的所有模块，以及他们依赖的模块。</p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>
                    $ npm list
                </p>
            </div>
        </div>
        <div class="carration">
            <p>
                加上global参数，会列出全局安装的模块。
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>
                    $ npm list -global
                </p>
            </div>
        </div>
        <div class="carration">
            <p>
                <code>npm list</code>命令也可以列出单个模块。
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>
                    $ npm list underscore
                </p>
            </div>
        </div>
        <h2 id="install">8. npm install</h2>
        <h3 id="install-one">8.1 基本用法</h3>
        <div class="carration">
            <p>
                Node模块采用<code>npm install</code>命令安装。
            </p>
        </div>
        <div class="carration">
            <p>
                每个模块可以“全局安装”，也可以“本地安装”。“全局安装”指的是将一个模块安装到系统目录中，各个项目都可以调用。一般来说，全局安装只适用于工具模块，比如<code>eslint</code>和<code>gulp</code>。”本地安装“指的是将一个模块下载
                到当前项目的<code>node_modules</code>子目录，然后只有在项目之中，才能调用这个模块。
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <span># 本地安装</span>
                <p>$ npm install &lt;package name&gt;</p>
                <br>
                <br>
                <span># 全局安装</span>
                <p>$ sudo npm install -global &lt;package name&gt;</p>
                <p>$ sudo npm install -g &lt;package name&gt;</p>
            </div>
        </div>
        <div class="carration">
            <p>
                <code>npm install</code>也支持直接输入GitHub代码库地址。
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>
                    $ npm install git://github.com/package/path.git
                </p>
                <p>
                    $ npm install git://github.com/package/path.git#0.1.0
                </p>
            </div>
        </div>
        <div class="carration">
            <p>
                安装之前，<code>npm install</code>会先检查，<code>node_modules</code>目录之中是否有指定模块。如果存在，就不再重新安装了，即使远程仓库已经有了一个新版本，也是如此。
            </p>
            <br>
            <p>
                如果你希望，一个模块是否安装过，npm都要强制重新安装，也可以使用<code>-f</code>或者<code>--force</code>参数。
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>
                    $ npm install &lt;packageName&gt; --force
                </p>
            </div>
        </div>
        <div class="carration">
            <p>
                如果你希望，所有的模块都要强制重新安装，那就删除<code>node_modules</code>目录，重新执行<code>npm install</code>。
            </p>
        </div>
        <div class="code-carration">
            <div class="code">
                <p>
                    $ rm -rf node_modules
                </p>
                <p>
                    $ npm install
                </p>
            </div>
        </div>
        <h3 id="install-two">8.2 安装不同的版本</h3>
        <div class="carration">
            <p>
                install命令总是安装模块的最新版本，如果要安装模块的特定版本，可以在模块后边加上@和版本号。
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>
                    $ npm install sax@latest
                </p>
                <p>
                    $ npm install sax@0.1.1
                </p>
                <p>
                    $ npm install sax@"&gt;=0.1.0 &lt;0.2.0"
                </p>
            </div>
        </div>
        <div class="carration">
            <p>
                如果使用<code>--save-exact</code>参数， 会在package.json文件指定安装模块的确切版本。
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>
                    $ npm install readable-stream --save --save-exact
                </p>
            </div>
        </div>
        <div class="carration">
            <p>
                install命令可以使用不同的参数，指定所安装的模块属于哪一种性质的依赖关系，即出现在package.json文件的哪一项中。
            </p>
        </div>
        <div class="carration">
            <ul>
                <li>
                    &gt; -save: 模块名将被添加到dependencies，可以简化为参数 <code>-s</code>
                </li>
                <li>
                    &gt; -save-dev：模块名将被添加到devDependencies，简写为参数<code>-D</code>
                </li>
            </ul>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>
                    $ npm install sax --save
                </p>
                <p>
                    $ npm install node-tap --save-dev
                </p>
                <br>
                <span>
                    # 或者
                </span>
                <p>
                    $ npm install sax -S
                </p>
                <p>
                    $ npm install node-tap D
                </p>
            </div>
        </div>
        <div class="carration">
            <p>
                如果要安装beta版本的模块，需要使用下面的命令。
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <span>
                    # 安装最新版本的beta版
                </span>
                <p>
                    $ npm install &lt;module-name&gt;@beta (latest beta)
                </p>
                <br>
                <br>
                <span>
                    # 安装指定的beta版本
                </span>
                <p>
                    $ npm install &lt;module-name&gt;@1.3.1-beta.3
                </p>
            </div>
        </div>
        <div class="carration">
            <p>
                <code>npm install</code>默认会安装<code>dependencies</code>字段和<code>devDependencies</code>字段中的所有模块，如果
                使用<code>--production</code>参数，可以只安装字段<code>dependencies</code>中的模块。
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>
                    $ npm install --production
                </p>
                <br>
                <span>
                    # 或者
                </span>
                <p>
                    $ NODE_ENV=production npm install
                </p>
            </div>
        </div>
        <div class="carration">
            <p>
                一旦安装了某个模块就可以在代码中用<code>require</code>命令加载这个模块。
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>
                    var backbone = require('backbone')
                </p>
                <p>
                    console.log(backbone.VERSION)
                </p>
            </div>
        </div>
        <h2 id="root">9. 避免系统权限</h2>
        <div class="carration">
            <p>
                默认情况下，Npm全局模块都安装在系统目录，（比如<code>/usr/local/lib/</code>），普通用户没有写入权限，需要用到<code>sudo</code>
                命令。这很不方便，我们可以在没有root权限的情况下安装全局模块。
            </p>
            <br>
            <p>
                首先在主目录下创建配置文件<code>.npmrc</code>，然后在该文件中将<code>perfix</code>变量定义到主目录下边。
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>
                    prefix = home/yourUsernamr/npm
                </p>
            </div>
        </div>
        <div class="carration">
            <p>
                然后在主目录下创建<code>npm</code>子目录。
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>
                    $ mkdir ~/npm
                </p>
            </div>
        </div>
        <div class="carration">
            <p>
                此后，全局安装的模块都会安装在这个子目录下，npm也会到<code>~/npm/bin</code>目录中去寻找命令。
            </p>
            <p>
                最后，将这个路径在<code>.bash_profile</code>文件（或<code>.bashrc</code>文件）中加入PATH变量。
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>
                    export PATH=~/npm/bin:$PATH
                </p>
            </div>
        </div>
        <h2 id="update">10. npm update, npm uninstall</h2>
        <div class="carration">
            <p>
                <code>npm update</code>可以更新本地安装的模块。
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <span># 更新当前目录的指定模块</span>
                <p>$ npm update [package name]</p>
                <br>
                <br>
                <span>
                    # 升级全局安装的模块
                </span>
                <p>
                    $ npm update -golbal [package name]
                </p>
            </div>
        </div>
        <div class="carration">
            <p>
                他会到远程仓库查看最新版本，然后查询本地版本。如果本地版本不存在，或者远程版本较新就会下载安装
            </p>
            <br>
            <p>
                使用<code>-s</code>或者<code>--save</code>参数，可以在安装的时候更新<code>package.json</code>里边模块的版本号。
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <span>// 更新之前的package.json</span>
                <p>
                    dependencies: {<br>
                        dep1: "^1.1.1"<br>
                    }<br>
                </p>
                <br>
                <br>
                <span>// 更新之后的package.json</span>
                <p>
                    dependencies: {<br>
                        dep: "^1.2.2"<br>
                    }<br>
                </p>
            </div>
        </div>
        <div class="carration">
            <p>
                注意，从npm v2.6.1开始，<code>npm update</code>只更新顶层模块，而不更新依赖的的依赖，以前版本是递归更新的。如果想取得
                老版本的效果，需要下边的命令。
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>$ npm --depth 999 update</p>
            </div>
        </div>
        <div class="carration">
            <p>
                <code>npm uninstall</code>命令卸载已经安装了的模块
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>
                    $ npm uninstall [package name]
                </p>
                <br>
                <br>
                <span>
                    # 卸载全局安装的模块
                </span>
                <p>
                    $ npm uninstall [package name] -global
                </p>
            </div>
        </div>
        <h2 id="run">11. npm run</h2>
        <div class="carration">
            <p>
                <code>npm</code>不仅用于模块管理，也可以执行脚本。<code>package.json</code>中有<code>script</code>字段，可以用于指定
                脚本命令，供<code>npm</code>直接调用。
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>
                    {<br>
                        "name": "myproject",<br>
                        "devDependencies": {<br>
                          "jshint": "latest",<br>
                          "browserify": "latest",<br>
                          "mocha": "latest"<br>
                        },<br>
                        "scripts": {<br>
                          "lint": "jshint **.js",<br>
                          "test": "mocha test/"<br>
                        }<br>
                      }<br>                    
                </p>
            </div>
        </div>
        <div class="carration">
            <p>
                上边代码中，<code>scritpt</code>字段指定了两项命令<code>lint</code>和<code>test</code>,命令输入<code>npm run-sctipt lint</code>
                或<code>npm run lint</code>，就会执行<code>jshint **.js</code>，输入<code>npm run-sctipt test</code>或者<code>npm run test</code>,就会执行
                <code>mocha test/</code>。<code>npm run</code>是<code>npm run-script</code>的缩写。一般使用前者，但是后者更反映出这个命令的本质
            </p>
            <br>
            <p>
                <code>npm run </code>命令会自动在<code>$PATH</code>环境变量中添加<code>node_modules/.bin</code>目录，所以<code>script</code>字段调用命令时不用
                加上路径，这就避免了全局安装NPM模块。
            </p>
            <br>
            <p>
                <code>npm run</code>如果不加任何参数，直接运行，会列出<code>package.json</code>中所有的可执行脚本命令
            </p>
            <br>
            <p>
                npm内置了两个命令简写，<code>npm test</code>相当于<code>npm run test</code>，还有一个是<code>npm start</code>相当于<code>npm run start</code>
            </p>
            <br>
            <p><code>npm run</code> 会创建一个Shell</p>执行指定的命令，并临时将<code>node_modules/.bin</code>添加到PATH变量，这意味着本地模块可以直接运行。
            <br>
            <p>
                举例来说执行安装ESlint模块的命令
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>$ npm i eslint --save-dev</p>
            </div>
        </div>
        <div class="carration">
            <p>运行上边的代码会产生两个结果。首先Eslint会安装到当前项目的<code>node_modules</code>子目录，其次<code>node_modules/.bin</code>
            目录会生成一个符号链接<code>node_modules/.bin/eslint</code>，指向ESlint的可执行脚本 </p><br>
            <p>
                然后你就可以在<code>package.json</code>的<code>script</code>属性里不带路径的使用ESlint这个脚本。
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>
                    {<br>
                        "name": "Test Project",<br>
                        "devDependencies": {<br>
                          "eslint": "^1.10.3"<br>
                        },<br>
                        "scripts": {<br>
                          "lint": "eslint ."<br>
                        }<br>
                      }<br>   
                </p>
            </div>
        </div>
        <div class="carration">
            <p>
                等到运行<code>npm run eslint</code>的时候，他会自动执行<code>node_modules/.bin/eslint .</code>。
            </p>
            <p>如果直接运行<code>npm run</code>不加参数，他会列出<code>scritp</code>属性下所有命令</p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <code>
                    <pre>
                        $ npm run
                        Available scripts in the user-service package:
                        lint
                            jshint **.js
                        test
                            mocha test/
                    </pre>
                </code>
            </div>
        </div>
        <div class="carration">
            <p>下边是另外一个<code>package.json</code>文件的例子</p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <code>
                    <pre>
                        "scripts": {
                            "watch": "watchify client/main.js -o public/app.js -v",
                            "build": "browserify client/main.js -o public/app.js",
                            "start": "npm run watch & nodemon server.js",
                            "test": "node test/all.js"
                          },                          
                    </pre>
                </code>
            </div>
        </div>
        <div class="carration">
            <p>上边代码在<code>scripts</code>项，定义了四个别名，每个别名都有对应的脚本命令。</p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>$ npm run watch</p>
                <p>$ npm run build</p>
                <p>$ npm run start</p>
                <p>$ npm run test</p>
            </div>
        </div>
        <div class="carration">
            <p>其中start 和test 都可以使用简写，可以省略run</p>
            <br>
            <p>如果希望一个命令的输出是另外一个命令的输入  可以用Linux系统的管道命令，将两个操作连接在一起，
                也可以使用简单的方法<code>npm run</code>命令
            </p>
        </div>
        <h4>11.1 参数</h4>
        <div class="carration">
            <p>
                <code>npm run</code>命令还可以添加参数
            </p>
        </div>
        <div class="code-abroad">
            <div class="code">
                <p>
                    <code>
                        <pre>
                            "scripts": {
                                "test": "mocha test/"
                              }                              
                        </pre>
                    </code>
                </p>
            </div>
        </div>
        <div class="carration">
            <p>上面的代码指定<code>npm test</code>，实际运行<code>mocha test/</code> </p>
        </div>
        <h1>11.2 script脚本命令最佳实践</h1>
        <h2>12. npm link</h2>
        <h2>13. npm bin</h2>
        <h2>14. npm adduser</h2>
        <h2>15. npm publish</h2>
        <h2>16. npm deprecate</h2>
        <h2>17. npm owner</h2>
        <h2>18. 其他命令</h2>
        <h2>19.参考链接</h2>
    </div>
</body>
</html>